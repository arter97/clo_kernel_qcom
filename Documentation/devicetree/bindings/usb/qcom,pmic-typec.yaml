# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: "http://devicetree.org/schemas/usb/qcom,pmic-typec.yaml#"
$schema: "http://devicetree.org/meta-schemas/core.yaml#"

title: Qualcomm PMIC based USB type C Detection Driver

maintainers:
  - Wesley Cheng <wcheng@codeaurora.org>

description: |
  Qualcomm PMIC Type C Detect

properties:
  compatible:
    enum:
      - qcom,pm8150b-usb-typec

  reg:
    maxItems: 1
    description: Type C base address

  interrupts:
    maxItems: 1
    description: CC change interrupt from PMIC

  connector:
    description: Connector type for remote endpoints
    type: object

    properties:
      compatible:
        $ref: /connector/usb-connector.yaml#/properties/compatible
        enum:
          - usb-c-connector

      power-role: true
      data-role: true

      ports:
        description: Remote endpoint connections
        type: object
        $ref: /connector/usb-connector.yaml#/properties/ports

        properties:
          port@0:
            description: Remote endpoints for the High Speed path
            type: object

          port@1:
            description: Remote endpoints for the Super Speed path
            type: object

            properties:
              endpoint@0:
                description: Connection to USB type C mux node
                type: object

              endpoint@1:
                description: Connection to role switch node
                type: object

    required:
      - compatible

required:
  - compatible
  - interrupts
  - connector

additionalProperties: false

examples:
  - |
    #include <dt-bindings/interrupt-controller/irq.h>
    pm8150b {
        #address-cells = <1>;
        #size-cells = <0>;
        pm8150b_typec: typec@1500 {
            compatible = "qcom,pm8150b-usb-typec";
            reg = <0x1500>;
            interrupts = <0x2 0x15 0x5 IRQ_TYPE_EDGE_RISING>;

            connector {
                compatible = "usb-c-connector";
                power-role = "dual";
                data-role = "dual";
                ports {
                    #address-cells = <1>;
                    #size-cells = <0>;
                    port@0 {
                        reg = <0>;
                    };
                    port@1 {
                        reg = <1>;
                        #address-cells = <1>;
                        #size-cells = <0>;
                        usb3_data_ss: endpoint@0 {
                            reg = <0>;
                            remote-endpoint = <&qmp_ss_mux>;
                        };
                        usb3_role: endpoint@1 {
                            reg = <1>;
                            remote-endpoint = <&dwc3_drd_switch>;
                        };
                    };
                };
            };
        };
    };
...
