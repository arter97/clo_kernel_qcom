# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/dma/qcom_bam_dma.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: QCOM BAM DMA controller binding

maintainers:
  - Bhupesh Sharma <bhupesh.sharma@linaro.org>

description: |
  This document defines the binding for the BAM DMA controller
  found on Qualcomm parts.

allOf:
  - $ref: "dma-controller.yaml#"

properties:
  compatible:
    enum:
      - qcom,bam-v1.3.0 # for APQ8064, IPQ8064 and MSM8960
      - qcom,bam-v1.4.0 # for MSM8974, APQ8074 and APQ8084
      - qcom,bam-v1.7.0 # for MSM8916

  reg:
    maxItems: 1

  clocks:
    maxItems: 1

  clock-names:
    const: bam_clk

  interrupts:
    minItems: 1
    maxItems: 31

  num-channels:
    maximum: 31
    description:
      Indicates supported number of DMA channels in a remotely controlled bam.

  "#dma-cells":
    const: 1
    description: The single cell represents the channel index.

  interconnects:
    maxItems: 1
    description:
      Interconnect path between bam and main memory.

  interconnect-names:
    const: memory

  iommus:
    minItems: 1
    maxItems: 8
    description:
      phandle(s) to apps_smmu node with sid mask.

  qcom,ee:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 0
    maximum: 7
    description:
      Indicates the active Execution Environment identifier (0-7)
      used in the secure world.

  qcom,controlled-remotely:
    $ref: /schemas/types.yaml#/definitions/flag
    description:
      Indicates that the bam is controlled by remote proccessor i.e.
      execution environment.

  qcom,powered-remotely:
    $ref: /schemas/types.yaml#/definitions/flag
    description:
      Indicates that the bam is powered up by a remote processor
      but must be initialized by the local processor.

  qcom,num-ees:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 0
    maximum: 31
    default: 2
    description:
      Indicates supported number of Execution Environments in a
      remotely controlled bam.

required:
  - compatible
  - reg
  - interrupts
  - "#dma-cells"
  - qcom,ee

additionalProperties: false

examples:
  - |
    #include <dt-bindings/clock/qcom,gcc-msm8974.h>
    dma-controller@f9984000 {
        compatible = "qcom,bam-v1.4.0";
        reg = <0xf9984000 0x15000>;
        interrupts = <0 94 0>;
        clocks = <&gcc GCC_BAM_DMA_AHB_CLK>;
        clock-names = "bam_clk";
        #dma-cells = <1>;
        qcom,ee = <0>;
        iommus = <&apps_smmu 0x584 0x0011>,
                 <&apps_smmu 0x586 0x0011>,
                 <&apps_smmu 0x594 0x0011>,
                 <&apps_smmu 0x596 0x0011>;
    };
